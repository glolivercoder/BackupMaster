# üìö Documenta√ß√£o do Sistema BackupMaster

## üéØ **Vis√£o Geral**

O BackupMaster √© um sistema completo de backup automatizado que integra com Terabox e Gmail, desenvolvido em Flutter para Windows. O sistema cria arquivos ZIP protegidos por senha, faz upload para a nuvem e envia relat√≥rios detalhados por email.

---

## üèóÔ∏è **Arquitetura do Sistema**

### **Padr√£o MVVM (Model-View-ViewModel)**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   View Layer    ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ  ViewModel      ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ   Model Layer   ‚îÇ
‚îÇ (Flutter UI)    ‚îÇ    ‚îÇ  (Provider)     ‚îÇ    ‚îÇ (Services/Data) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### **Estrutura de Diret√≥rios**

```
lib/
‚îú‚îÄ‚îÄ main.dart                 # Ponto de entrada da aplica√ß√£o
‚îú‚îÄ‚îÄ models/                   # Modelos de dados (gerados pelo Drift)
‚îú‚îÄ‚îÄ views/                    # Interfaces de usu√°rio (Pages)
‚îÇ   ‚îú‚îÄ‚îÄ home_page.dart       # Dashboard principal
‚îÇ   ‚îú‚îÄ‚îÄ search_page.dart     # Busca interativa de backups
‚îÇ   ‚îú‚îÄ‚îÄ history_page.dart    # Hist√≥rico de backups
‚îÇ   ‚îî‚îÄ‚îÄ settings_page.dart   # Configura√ß√µes do sistema
‚îú‚îÄ‚îÄ viewmodels/              # L√≥gica de apresenta√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ backup_viewmodel.dart
‚îÇ   ‚îú‚îÄ‚îÄ search_viewmodel.dart
‚îÇ   ‚îî‚îÄ‚îÄ history_viewmodel.dart
‚îú‚îÄ‚îÄ services/                # Servi√ßos de neg√≥cio
‚îÇ   ‚îú‚îÄ‚îÄ backup_service.dart  # Cria√ß√£o e gerenciamento de backups
‚îÇ   ‚îú‚îÄ‚îÄ terabox_service.dart # Integra√ß√£o com Terabox (OAuth2)
‚îÇ   ‚îú‚îÄ‚îÄ gmail_service.dart   # Envio de emails
‚îÇ   ‚îú‚îÄ‚îÄ password_manager.dart # Gerenciamento seguro de senhas
‚îÇ   ‚îî‚îÄ‚îÄ database.dart        # Banco de dados local (Drift/SQLite)
‚îî‚îÄ‚îÄ utils/                   # Utilit√°rios
    ‚îî‚îÄ‚îÄ app_theme.dart       # Tema escuro e paleta de cores
```

---

## üé® **Design System**

### **Paleta de Cores**

| Cor | C√≥digo | Uso |
|-----|--------|-----|
| **Verde** | `#4CAF50` | A√ß√µes principais, sucesso |
| **Azul** | `#2196F3` | A√ß√µes secund√°rias, informa√ß√µes |
| **Laranja** | `#FF9800` | Alertas, senhas |
| **Ciano** | `#00BCD4` | Destaques, tamanhos |
| **Vermelho** | `#F44336` | Erros, exclus√µes |

### **Tema Escuro**

- **Background**: `#121212`
- **Surface**: `#1E1E1E`
- **Cards**: `#2C2C2C`
- **Texto Prim√°rio**: `#FFFFFF`
- **Texto Secund√°rio**: `#B0B0B0`

---

## üîß **Funcionalidades Principais**

### **1. Cria√ß√£o de Backups**

- **Sele√ß√£o de Diret√≥rio**: Interface moderna com file_picker
- **Compacta√ß√£o ZIP**: Usando package `archive`
- **Prote√ß√£o por Senha**: Senhas de 12+ caracteres alfanum√©ricos
- **Nomenclatura Autom√°tica**: `nome_diretorio_DD-MM-AAAA_HH-MM-SS.zip`
- **Valida√ß√£o de Integridade**: Checksum MD5

### **2. Integra√ß√£o com Terabox (OAuth2)**

- **Autentica√ß√£o Real**: OAuth2 completo implementado
- **Upload Autom√°tico**: Arquivos enviados para a nuvem
- **Sistema de Retry**: 3 tentativas em caso de falha
- **Gerenciamento de Quota**: Verifica√ß√£o de espa√ßo dispon√≠vel

### **3. Sistema de Email (Gmail)**

- **Autentica√ß√£o por Senha de App**: Seguran√ßa aprimorada
- **Relat√≥rios HTML**: Templates responsivos
- **Lista de Backups**: Inclui senhas e metadados
- **Sistema de Retry**: 2 tentativas para envio

### **4. Busca Interativa**

- **Busca em Tempo Real**: Resultados instant√¢neos
- **Autocompletar**: Sugest√µes baseadas em backups existentes
- **Hist√≥rico de Buscas**: √öltimas 10 buscas salvas
- **Filtros R√°pidos**: Por data (hoje, semana, m√™s) e tamanho
- **C√≥pia de Senha**: Um clique para copiar para clipboard

### **5. Gerenciamento de Senhas**

- **Gera√ß√£o Segura**: Algoritmo criptograficamente seguro
- **Criptografia AES**: Armazenamento protegido
- **Backup Autom√°tico**: Arquivo separado para recupera√ß√£o
- **Limpeza de Clipboard**: Remo√ß√£o autom√°tica ap√≥s 30s

---

## üóÑÔ∏è **Banco de Dados**

### **Esquema SQLite (Drift)**

#### **Tabela: backups**
```sql
CREATE TABLE backups (
    id TEXT PRIMARY KEY,
    name TEXT NOT NULL,
    original_path TEXT NOT NULL,
    zip_path TEXT,
    terabox_url TEXT,
    password_hash TEXT NOT NULL,
    file_size INTEGER,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    status TEXT DEFAULT 'creating',
    checksum TEXT
);
```

#### **Tabela: email_logs**
```sql
CREATE TABLE email_logs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    backup_id TEXT,
    sent_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    recipient TEXT,
    status TEXT,
    error_message TEXT
);
```

#### **Tabela: password_logs**
```sql
CREATE TABLE password_logs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    backup_id TEXT,
    password_generated TEXT,
    password_hash TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    test_result TEXT,
    validation_status TEXT DEFAULT 'pending'
);
```

---

## üîê **Seguran√ßa**

### **Criptografia de Senhas**

- **Algoritmo**: AES-256-GCM
- **Chave**: Derivada usando PBKDF2
- **Salt**: √önico para cada senha
- **Verifica√ß√£o**: Hash SHA-256 para valida√ß√£o

### **Prote√ß√£o de Dados**

- **Senhas ZIP**: Nunca armazenadas em texto plano
- **Clipboard**: Limpeza autom√°tica ap√≥s uso
- **Logs**: Informa√ß√µes sens√≠veis mascaradas
- **OAuth2**: Tokens seguros com refresh autom√°tico

---

## üì± **Interface do Usu√°rio**

### **P√°gina Principal (Home)**

- **Dashboard**: Estat√≠sticas de backups
- **A√ß√µes R√°pidas**: Bot√µes para funcionalidades principais
- **Status do Sistema**: Indicadores de conectividade
- **√öltimos Backups**: Lista dos 5 mais recentes

### **P√°gina de Busca**

- **SearchBar Interativa**: 
  - Busca em tempo real
  - Autocompletar com sugest√µes
  - Hist√≥rico de buscas recentes
  - Contador de resultados
- **Filtros R√°pidos**:
  - Por data (hoje, semana, m√™s)
  - Por tamanho (arquivos grandes >100MB)
- **Resultados**:
  - Cards modernos com informa√ß√µes completas
  - C√≥pia de senha com um clique
  - Abertura de pasta original
  - Abertura do ZIP com senha

### **P√°gina de Hist√≥rico**

- **Lista Cronol√≥gica**: Backups em ordem decrescente
- **Formata√ß√£o Brasileira**: DD/MM/AAAA HH:MM:SS
- **Informa√ß√µes Detalhadas**: Nome, tamanho, status, senha
- **A√ß√µes R√°pidas**: Abrir, copiar senha, excluir

### **P√°gina de Configura√ß√µes**

- **Se√ß√£o Terabox**: Configura√ß√£o OAuth2
- **Se√ß√£o Gmail**: Configura√ß√£o de senha de app
- **Testes de Conectividade**: Valida√ß√£o em tempo real
- **Logs do Sistema**: Visualiza√ß√£o de atividades
- **Manual de Autentica√ß√£o**: Guia passo a passo

---

## üîÑ **Fluxo de Backup**

### **Processo Completo**

1. **Sele√ß√£o**: Usu√°rio escolhe diret√≥rio
2. **Valida√ß√£o**: Sistema verifica permiss√µes e espa√ßo
3. **Compacta√ß√£o**: Cria√ß√£o do arquivo ZIP com senha
4. **Armazenamento**: Salvamento local tempor√°rio
5. **Upload**: Envio para Terabox via OAuth2
6. **Registro**: Inser√ß√£o no banco de dados
7. **Email**: Envio de relat√≥rio via Gmail
8. **Limpeza**: Remo√ß√£o de arquivos tempor√°rios

### **Estados do Backup**

- `creating`: Criando arquivo ZIP
- `uploading`: Enviando para Terabox
- `completed`: Processo conclu√≠do com sucesso
- `failed`: Falha em alguma etapa
- `deleted`: Backup removido pelo usu√°rio

---

## üß™ **Sistema de Testes**

### **Testes de Senha**

- **Gera√ß√£o**: Valida√ß√£o de complexidade
- **Criptografia**: Teste de encrypt/decrypt
- **Integridade**: Verifica√ß√£o de hashes
- **Performance**: Tempo de processamento

### **Testes de Integra√ß√£o**

- **Terabox**: Upload e download de arquivos
- **Gmail**: Envio e formata√ß√£o de emails
- **Banco de Dados**: CRUD operations
- **Interface**: Navega√ß√£o e intera√ß√µes

---

## üìä **Monitoramento e Logs**

### **Sistema de Logging**

- **N√≠veis**: DEBUG, INFO, WARNING, ERROR
- **Formato**: Timestamp, classe, n√≠vel, mensagem
- **Armazenamento**: Arquivo local rotativo
- **Visualiza√ß√£o**: Interface na p√°gina Settings

### **M√©tricas**

- **Backups Criados**: Contador total
- **Taxa de Sucesso**: Percentual de uploads bem-sucedidos
- **Tempo M√©dio**: Dura√ß√£o do processo completo
- **Uso de Espa√ßo**: Terabox e armazenamento local

---

## üöÄ **Instala√ß√£o e Configura√ß√£o**

### **Pr√©-requisitos**

- **Flutter SDK**: 3.0+
- **Dart SDK**: 3.0+
- **Windows**: 10/11
- **Conta Google**: Para Gmail e Terabox
- **Baidu Developer Account**: Para OAuth2 do Terabox

### **Configura√ß√£o Inicial**

1. **Clone o reposit√≥rio**
2. **Execute `flutter pub get`**
3. **Configure credenciais OAuth2** (veja OAUTH2_SETUP.md)
4. **Configure senha de app Gmail** (veja ManualdeAutenticacao.md)
5. **Execute `flutter run`**

---

## üîß **Manuten√ß√£o**

### **Backup do Banco de Dados**

- **Autom√°tico**: A cada 100 opera√ß√µes
- **Manual**: Bot√£o na p√°gina Settings
- **Localiza√ß√£o**: Pasta Documents/BackupMaster/db_backups/

### **Limpeza de Arquivos**

- **Tempor√°rios**: Removidos ap√≥s cada backup
- **Logs**: Rota√ß√£o a cada 10MB
- **Cache**: Limpeza semanal autom√°tica

### **Atualiza√ß√µes**

- **Verifica√ß√£o**: Autom√°tica na inicializa√ß√£o
- **Download**: Manual pelo usu√°rio
- **Migra√ß√£o**: Banco de dados versionado

---

## üêõ **Troubleshooting**

### **Problemas Comuns**

#### **Erro de Autentica√ß√£o Terabox**
- **Causa**: Credenciais OAuth2 inv√°lidas
- **Solu√ß√£o**: Reconfigurar no Baidu Developer Console

#### **Email n√£o enviado**
- **Causa**: Senha de app incorreta
- **Solu√ß√£o**: Gerar nova senha no Google Account

#### **Backup falha**
- **Causa**: Permiss√µes de arquivo ou espa√ßo insuficiente
- **Solu√ß√£o**: Verificar permiss√µes e espa√ßo em disco

### **Logs de Diagn√≥stico**

- **Localiza√ß√£o**: Settings ‚Üí Logs do Sistema
- **Filtros**: Por n√≠vel e data
- **Exporta√ß√£o**: Arquivo .txt para suporte

---

## üìà **Roadmap**

### **Vers√£o Atual (1.0)**
- ‚úÖ Backup ZIP com senha
- ‚úÖ Integra√ß√£o Terabox OAuth2
- ‚úÖ Envio de emails Gmail
- ‚úÖ Busca interativa
- ‚úÖ Interface moderna

### **Pr√≥ximas Vers√µes**

#### **v1.1**
- üîÑ Backup incremental
- üîÑ Agendamento autom√°tico
- üîÑ M√∫ltiplos destinos de nuvem

#### **v1.2**
- üîÑ Sincroniza√ß√£o entre dispositivos
- üîÑ API REST para integra√ß√£o
- üîÑ Dashboard web

#### **v2.0**
- üîÑ Suporte Linux/macOS
- üîÑ Backup de bancos de dados
- üîÑ Criptografia end-to-end

---

## üìû **Suporte**

### **Documenta√ß√£o Adicional**

- **Manual de Autentica√ß√£o**: `ManualdeAutenticacao.md`
- **Configura√ß√£o OAuth2**: `OAUTH2_SETUP.md`
- **Configura√ß√£o Gmail**: `CONFIGURACAO_GMAIL_TERABOX.md`

### **Contato**

- **Issues**: GitHub Issues
- **Email**: suporte@backupmaster.com
- **Documenta√ß√£o**: Wiki do projeto

---

*Documenta√ß√£o atualizada em Janeiro 2025 - BackupMaster v1.0*